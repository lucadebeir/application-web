<section class="contact pt-100 pb-100" id="contact">
    <div class="container">
        <div class="text-center">
            <h1>Modifier la recette</h1>
        </div>

        <table class="table col-md-8 mx-auto">
            <form class="form-inline" id="titre" (submit)="updateRecipeName(recette)">


                <tr>
                    <td>
                        <input id="zone" type="text" class="form-control" name="nomRecette" value="{{recette?.nomRecette}}" #nomRecette="ngModel" [(ngModel)]="recette.nomRecette">
                    </td>
                    <td>
                        <button id="btnTitre" class="btn btn-outline-dark" type="submit">Modifier</button>
                    </td>
            </form>

            <form>


                <div *ngIf="!image">
                    <div style="text-align: center">
                        <form>
                            <tr>
                                <td>
                                    <input type="file" name="image" (change)="selectImage($event)" />

                                </td>
                                <td>
                                    <button type="submit" class="btn btn-warning" (click)="onSubmit()">Modifier</button>

                                </td>
                            </tr>
                        </form>
                    </div>
                </div>


                <div *ngIf="image">
                    <tr>
                        <td>
                            <img src="{{image.lienImage}}" class="rounded mx-auto d-block" alt="Responsive image" id="resp">
                        </td>
                        <td>
                            <button id="btnTitre" class="btn btn-outline-warning" type="submit">Modifier</button>
                        </td>
                    </tr>

                    <!-- Modal -->
                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Modification de l'image de la recette
                                    </h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                                </div>
                                <div class="modal-body">
                                    <figcaption class="figure-caption">
                                        <!--bouton modifier photo à faire-->
                                        <div style="text-align: center">
                                            <form>
                                                <div>
                                                    <input type="file" name="image" (change)="selectImage($event)" />
                                                </div>
                                            </form>
                                        </div>
                                    </figcaption>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary" (click)="onSubmit()">Modifier</button>
                                </div>
                            </div>
                        </div>
                    </div>



                </div>

            </form>

            <tr>

                <td>
                    <label>Catégories</label>
                </td>
                <td>
                    <!--catégories de la recette-->
                    <div *ngFor="let categ of categories">
                        <button id="poubelle" class="btn btn-sm btn-danger" (click)="deleteRecipeCategory(categ,recette)"><i
                class="fa fa-trash"></i></button> {{categ.libelleCategorie}}
                    </div>
                </td>
                <td>
                    <!--catégorie dont la recette ne fait pas partie-->
                    <div *ngFor="let cat of allCategories">
                        <button id="add" class="btn btn-sm btn-success" (click)="addRecipeCategory(cat,recette)"><i
                class="fa fa-plus-circle"></i></button> {{cat.libelleCategorie}}

                    </div>
                </td>
            </tr>
            <br>


            <form (submit)="updatePart(recette)">
                <tr>
                    <td>
                        <label>Nombre de parts</label>

                        <input type="number" class="form-control" [(ngModel)]="recette.nbrePart" [ngModelOptions]="{standalone: true}" value="{{recette.nbrePart}}" required>
                        <div class="invalid-tooltip">
                            Rentrez une quantité correcte.
                            <!--Vérifier que c'est pas négatif ou nulle-->
                        </div>
                    </td>
                    <td>
                        <label>Libellé des parts</label>
                        <input type="text" class="form-control" [(ngModel)]="recette.libellePart" [ngModelOptions]="{standalone: true}" value="{{recette.libellePart}}" required>
                        <div class="invalid-tooltip">
                            Rentrez une quantité correcte.
                            <!--Vérifier que c'est pas négatif ou nulle-->
                        </div>
                    </td>
                    <td>
                        <button id="btn" class="btn btn-outline-info" type="submit">Modifier</button>
                    </td>
                </tr>
            </form>




            <form (submit)="updateTemps(recette)">
                <tr>
                    <td>

                        <label>Temps de préparation</label>

                        <input type="time" class="form-control" [(ngModel)]="recette.tempsPreparation" [ngModelOptions]="{standalone: true}" value="{{recette.tempsPreparation}}" required>
                        <div class="invalid-tooltip">
                            Rentrez une quantité correcte.
                            <!--Vérifier que c'est pas négatif ou nulle-->
                        </div>


                    </td>
                    <td>
                        <label>Cuisson</label>
                        <input type="time" class="form-control" [(ngModel)]="recette.tempsCuisson" [ngModelOptions]="{standalone: true}" value="{{recette.tempsCuisson}}" required>
                        <div class="invalid-tooltip">
                            Rentrez une quantité correcte.
                            <!--Vérifier que c'est pas négatif ou nulle-->
                        </div>

                    </td>
                    <td>

                        <button id="btn" class="btn btn-outline-dark" type="submit">Modifier</button>
                    </td>
                </tr>
            </form>



            <tr>
                <td>
                    <label>Ingrédients</label>

                    <ul>
                        <div *ngFor="let ingredient of ingredients" class="card-text">

                            <form (submit)="updateRecipeIng(recette,ingredient)">

                                <p>{{ingredient.nomIngredient}}</p>

                                <td>


                                    <input id="qte" type="text" class="form-control" name="qte" value="{{ingredient.qte}}" #qte="ngModel" [(ngModel)]="ingredient.qte">
                                </td>
                                <td>
                                    <select class="custom-select" id="unit" #idUnite="ngModel" [(ngModel)]="ingredient.idUnite" [ngModelOptions]="{standalone: true}" required>
                                        <option [ngValue]="ingredient.idUnite" selected>{{ingredient.libelleUnite}}
                                        </option>
                                        <option *ngFor="let unite of allUnites" [ngValue]="unite.idUnite">
                                            {{unite.libelleUnite}}
                                        </option>
                                    </select>
                                </td>
                                <td>

                                    <button id="crayon" class="btn btn-sm btn-warning"><i class="fa fa-pencil" aria-hidden="true"></i></button>
                                </td>
                                <td>
                                    <button id="poubelle" class="btn btn-sm btn-danger" (click)=deleteIngredientRececipe(ingredient,recette)><i
                                    class="fa fa-trash"></i></button>




                            </form>


                        </div>
                        <ng-template #content let-modal>
                            <!--ce qui s'ouvre quand on clique sur créer un nouvel ingrédient-->
                            <div class="modal-header">
                                <h4 class="modal-title"></h4>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-row">
                                        <div class="col-md-3 mb-3">
                                            <label for="validationTooltip04">Ingrédient</label>
                                            <select class="custom-select" id="validationTooltip04" #idIngredient="ngModel" [(ngModel)]="newIngredient.idIngredient" [ngModelOptions]="{standalone: true}" required>
                                        <option *ngFor="let ingredient of allIngredients"
                                            [ngValue]="ingredient.idIngredient">
                                            {{ingredient.nomIngredient}}</option>
                                    </select>
                                            <div class="invalid-tooltip">
                                                Selectionnez un ingrédient.
                                            </div>
                                        </div>

                                        <div class="col-md-3 mb-3">
                                            <label for="validationTooltip05">Quantité</label>
                                            <input type="number" class="form-control" id="validationTooltip05" #qte="ngModel" [(ngModel)]="newIngredient.qte" [ngModelOptions]="{standalone: true}" required>
                                            <div class="invalid-tooltip">
                                                Rentrez une quantité correcte.
                                                <!--Vérifier que c'est pas négatif ou nulle-->
                                            </div>
                                        </div>

                                        <div class="col-md-3 mb-3">
                                            <label for="validationTooltip04">Unité</label>
                                            <select class="custom-select" id="validationTooltip04" #idUnite="ngModel" [(ngModel)]="newIngredient.idUnite" [ngModelOptions]="{standalone: true}" required>
                                        <option *ngFor="let unite of allUnites" [ngValue]="unite.idUnite">
                                            {{unite.libelleUnite}}
                                        </option>
                                    </select>
                                            <div class="invalid-tooltip">
                                                Selectionnez une unité.
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button tyoe="button" class="btn btn-outline-dark" (click)="modal.close(newIngredient)">Ajouter</button>
                            </div>
                        </ng-template>

                        <!--on appelle le modal-->


                    </ul>

            </tr>
            <tr>
                <td>
                    <button class="btn btn-outline-primary" (click)="open(content)">Ajouter un nouvel ingrédient</button>
                </td>
            </tr>

            <tr>
                <td>
                    <label>Préparation</label>



                    <form (submit)="updateSteps(recette)">

                        <textarea class="form-control" #etapes="ngModel" rows="15em" name="etapes" [(ngModel)]="recette.etapes" [ngModelOptions]="{standalone: true}" value=" {{recette?.etapes}}"></textarea>
                        <br>
                        <button id="btn" class="btn btn-outline-success" type="submit">Modifier</button>

                    </form>

                    <tr>
                        <br>
                        <label>Astuces</label>
                        <form (submit)="updateAstuce(recette)">
                            <textarea class="form-control" #etapes="ngModel" rows="15em" name="astuce" [(ngModel)]="recette.astuce" [ngModelOptions]="{standalone: true}" value=" {{recette?.astuce}}"></textarea>
                            <br>
                            <button id="btn" class="btn btn-outline-success" type="submit">Modifier</button>
                        </form>
                    </tr>